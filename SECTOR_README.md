# 板块资金查询功能说明

## 🎯 功能概述

板块资金查询功能是A股金融数据分析系统的重要组成部分，提供中国股市各板块的资金流向分析功能。

## 📊 主要功能

### 1. 板块概览模式
- **功能描述**: 查询所有板块的资金流向排行榜
- **数据内容**: 
  - 主力资金净流入/流出情况
  - 板块涨跌幅统计
  - 市场情绪分析
  - 资金流向排行榜

### 2. 单板块详情模式
- **功能描述**: 深入分析单个板块的详细情况
- **数据内容**:
  - 板块成分股列表
  - 个股资金流向排行
  - 板块强度分析
  - 龙头效应评估

## 🚀 使用方法

### Web界面使用
1. 启动应用: `streamlit run app.py`
2. 在主页点击"进入板块资金查询"
3. 选择查询模式:
   - **板块概览**: 点击"查询所有板块"
   - **单板块详情**: 输入板块名称后点击"查询板块详情"

### 命令行使用
```python
from sector.fetcher import create_sector_fetcher
from sector.processor import create_sector_processor

# 创建组件
fetcher = create_sector_fetcher()
processor = create_sector_processor()

# 获取板块概览
sector_data = fetcher.get_sector_fund_flow()
processed_data = processor.process_sector_data(sector_data)

# 获取单板块详情
detail_data = fetcher.get_sector_detail("半导体")
analysis = processor.analyze_sector_detail("半导体", detail_data)
```

## 📈 数据说明

### 关键指标
- **主力资金**: 超大单+大单净流入金额（单位：亿元）
- **涨跌幅**: 板块平均涨跌幅（单位：%）
- **换手率**: 板块平均换手率（单位：%）
- **市场情绪**: 基于多项指标综合计算的情绪指数

### 排行榜类型
1. **资金流入榜**: 按主力资金净流入排序
2. **资金流出榜**: 按主力资金净流出排序  
3. **涨幅榜**: 按涨跌幅从高到低排序
4. **跌幅榜**: 按涨跌幅从低到高排序

## 🏢 常用板块名称

### 科技板块
- 半导体
- 人工智能
- 5G概念
- 云计算
- 大数据

### 新兴产业
- 新能源汽车
- 光伏概念
- 风电设备
- 储能
- 锂电池

### 传统行业
- 医药生物
- 白酒
- 房地产
- 银行
- 保险

## 📊 图表功能

### 板块概览图表
1. **资金流向分布**: 显示资金流入/流出板块数量
2. **涨跌幅分布**: 板块涨跌幅的分布直方图
3. **资金流向vs涨跌幅**: 散点图显示两者关系
4. **板块活跃度**: 按资金活跃度排序的条形图

### 板块详情图表
1. **个股资金流向**: 成分股的资金流向排行
2. **个股涨跌分布**: 成分股涨跌幅分布
3. **资金流向vs涨跌幅**: 个股层面的关系图
4. **龙头股表现**: 前5名个股的表现

### 市场情绪仪表盘
- 综合多项指标的市场情绪评分
- 0-100分制，分为5个等级
- 实时反映市场整体情绪状态

## ⚠️ 注意事项

### 数据获取
- 首次查询可能需要30-60秒
- 数据来源于akshare开源接口
- 建议在交易时间内查询以获取最新数据

### 网络连接
- 需要稳定的网络连接
- 网络异常时会明确提示数据获取失败
- 系统不会提供虚假数据，确保投资决策安全

### 缓存机制
- 系统会自动缓存当日数据
- 缓存有效期为1天
- 可通过"使用缓存数据"选项控制

## 🔧 技术架构

### 模块结构
```
sector/
├── __init__.py          # 模块初始化
├── fetcher.py           # 数据获取器
├── processor.py         # 数据处理器
└── visualizer.py        # 数据可视化器
```

### 依赖包
- akshare: 金融数据接口
- pandas: 数据处理
- numpy: 数值计算
- plotly: 交互式图表
- streamlit: Web界面

## 🐛 故障排除

### 常见问题
1. **连接超时**: 检查网络连接，稍后重试
2. **数据为空**: 可能是非交易时间或接口限制
3. **板块名称错误**: 参考常用板块名称列表
4. **图表不显示**: 检查浏览器JavaScript是否启用

### 错误处理
- 系统具有完善的错误处理机制
- 网络异常时会明确提示用户数据获取失败
- 所有错误都会记录到日志文件
- 不提供虚假数据，保障投资决策安全

## 📞 技术支持

如遇到问题，请检查：
1. 网络连接是否正常
2. 依赖包是否完整安装
3. 日志文件中的错误信息
4. 系统时间是否正确

## 🔄 更新日志

### v1.0.0 (2024-09-18)
- ✅ 实现板块概览功能
- ✅ 实现单板块详情查询
- ✅ 添加数据可视化图表
- ✅ 集成市场情绪分析
- ✅ 完善错误处理机制
- ✅ 添加缓存功能
- ✅ 移除模拟数据，确保数据真实性